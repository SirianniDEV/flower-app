import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'
import { useState, useEffect } from 'react'
import Lottie from 'lottie-react';
import { motion } from "framer-motion"

import Text from '../components/Text'
import ImageCard from '../components/ImageCard'
import InfoCard from '../components/InfoCard'
import Button from '../components/Button'
import CircleImage from '../components/CircleImage'
import record from '../Database/flower-database.json'
import LoadingAnimation from '../public/loading.json';

export default function Home() {


  const [info, setInfo] = useState(false)
  const [loading, setLoading] = useState(true);
  const [expand, setExpand] = useState(Array(record.length).fill(false));
  const [sel, setSel] = useState(0);

  const handleInfoClick = (index) => {
    setExpand((prevState) => {
      const nextState = [...prevState];
      nextState[index] = !nextState[index];
      return nextState;
    });
  };

  useEffect(() => {
    setTimeout(() => {
      setLoading(false);
    }, 6000);
  })

  if (loading) {
    return <div className={styles.Wrapper}>

      <Lottie style={{ width: 400, height: 400 }} animationData={LoadingAnimation} loop={true} />
      <Text align='center' padding='40px' size='40px' weight='700' txt='Loading' />
    </div>

  }


  return (
    <main className={styles.GalleryWrapper}>
      <Head>
        <title>Flower-Gallery</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/Flower Bouquet.png" />
      </Head>
      <motion.div className={styles.Header}
        initial={{ opacity: 0, x: -100 }}
        animate={{ opacity: 100, x: 0 }}
        transition={{ duration: 0.8, }}
      >
        <a href="/"><Button txt='Back' /></a>
      </motion.div>

      <motion.div className={styles.GalleryAbout}
        initial={{ opacity: 0, y: -100 }}
        animate={{ opacity: 100, y: 0 }}
        transition={{ duration: 0.8, }}>
        <Text align='center' padding='40px' size='40px' weight='700' txt='Flower Gallery' />
        <Text txt='The gallery displays flowers in three categories based on their level of maintenance required. These categories are as follows:' />
        <ul>
          <li><strong>Backyard Beginner (Easy):</strong> Easy to care for and require minimal maintenance. These flowers are suitable for beginners or those with limited time to devote to gardening</li>
          <li><strong>Green Thumb Grower (Medium):</strong> Flowers that require a bit more attention and care than those in the easy maintenance category. They may require more frequent watering, fertilizing, and pruning to keep them healthy and blooming</li>
          <li><strong>Flourishing Horticulturist (Hard):</strong> Includes flowers that are more challenging to grow and require a lot of care and attention to thrive. They may have specific soil and light requirements, and may need regular pest and disease control measures</li>
        </ul>

        <Text align='center' size='20px' weight='700' txt='Click on the flower image for more information!'/>
      </motion.div>

      <div className={styles.Gallery} id="container">

        <motion.div className={styles.Data}
          initial={{ opacity: 0 }}
          animate={{ opacity: 100 }}
          transition={{ duration: 0.8, delay: 1, }}
        >
          <Text position='sticky' align='center' padding='40px' size='40px' weight='700' txt='Backyard Beginner' />
          {record.map((rec, index, i) => {
            return rec.Maintenance == "low" ? (
              <motion.div onClick={() => handleInfoClick(index)} key={index}
                initial={{
                  opacity: 0,
                  y: 1000
                }}
                animate={{
                  opacity: 1,
                  y: sel === i ? 300 : 0,
                }}
                transition={{
                  duration: 1,
                  delay: 0.3,
                }}
              >
                <ImageCard Name={rec.Name} Type={rec.PlantType} src={rec.Image} />
                {expand[index] ? (
                  <InfoCard
                    descp={rec.Desc}
                    soil={rec.SoilNeeds}
                    height={rec.Height}
                    sun={rec.SunNeeds}
                    water={rec.WaterNeeds}
                    care={rec.Maintenance}
                  />
                ) : null}
              </motion.div>
            ) : null;
          })}
        </motion.div>

        <motion.div className={styles.Data}
          initial={{ opacity: 0 }}
          animate={{ opacity: 100 }}
          transition={{ duration: 0.8, delay: 1.3, }}>
          <Text align='center' padding='40px' size='40px' weight='700' txt='Green Thumb Grower' />
          {record.map((rec, index, i) => {
            return rec.Maintenance == "medium" ? (
              <motion.div onClick={() => handleInfoClick(index)} key={index}
                initial={{ opacity: 0, y: 1000 }}
                animate={{ opacity: 1, y: sel === i ? 300 : 0, }}
                transition={{ duration: 1, delay: 0.6 }}>
                <ImageCard Name={rec.Name} Type={rec.PlantType} src={rec.Image} />
                {expand[index] ? (
                  <InfoCard
                    descp={rec.Desc}
                    soil={rec.SoilNeeds}
                    height={rec.Height}
                    sun={rec.SunNeeds}
                    water={rec.WaterNeeds}
                    care={rec.Maintenance}
                  />
                ) : null}
              </motion.div>
            ) : null;
          })}
        </motion.div>

        <motion.div className={styles.Data}
          initial={{ opacity: 0 }}
          animate={{ opacity: 100 }}
          transition={{ duration: 0.8, delay: 1.6, }}>
          <Text align='center' padding='40px' size='40px' weight='700' txt='Flourishing Horticulturist ' />
          {record.map((rec, index, i) => {
            return rec.Maintenance == "hard" ? (
              <motion.div onClick={() => handleInfoClick(index)} key={index}
                initial={{ opacity: 0, y: 1000 }}
                animate={{ opacity: 1, y: sel === i ? 300 : 0, }}
                transition={{ duration: 1, delay: 0.6 }}>
                <ImageCard Name={rec.Name} Type={rec.PlantType} src={rec.Image} />
                {expand[index] ? (
                  <InfoCard
                    descp={rec.Desc}
                    soil={rec.SoilNeeds}
                    height={rec.Height}
                    sun={rec.SunNeeds}
                    water={rec.WaterNeeds}
                    care={rec.Maintenance}
                  />
                ) : null}
              </motion.div>
            ) : null;
          })}
        </motion.div>

      </div>
    </main>
  )
}
